{% set can_manage = membership.role in ['ADMIN', 'OWNER'] %}
<div id="schedules-panel" class="overflow-hidden rounded-2xl border border-slate-100">
  <table class="min-w-full text-left text-sm">
    <thead class="bg-slate-50 text-xs uppercase tracking-wide text-slate-500">
      <tr>
        <th class="px-4 py-3">Schedule</th>
        <th class="px-4 py-3">Group</th>
        <th class="px-4 py-3">Next Run</th>
        <th class="px-4 py-3 text-right">Actions</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-slate-100 bg-white">
      {% for schedule in schedules %}
      <tr>
        <td class="px-4 py-3">
          <p class="font-semibold text-slate-900">{{ schedule.name }}</p>
          <p class="text-xs text-slate-500">{{ schedule.frequency|title }} Â· every {{ schedule.interval_minutes }}m</p>
        </td>
        <td class="px-4 py-3 text-sm text-slate-600">{{ schedule.group_name }}</td>
        <td class="px-4 py-3 text-sm text-slate-600">{{ schedule.next_run.strftime('%b %d %H:%M') if schedule.next_run else 'Pending' }}</td>
        <td class="px-4 py-3 text-right">
          {% if can_manage %}
          <div class="flex items-center justify-end gap-3">
            <button
              class="text-xs font-semibold text-slate-700 hover:text-slate-900"
              hx-get="/api/schedules/modal/edit/{{ schedule.id }}"
              hx-target="#modal-root"
              hx-swap="innerHTML"
            >Edit</button>
            <button
              class="text-xs font-semibold text-rose-600 hover:text-rose-500"
              hx-get="/api/schedules/modal/delete/{{ schedule.id }}"
              hx-target="#modal-root"
              hx-swap="innerHTML"
            >Delete</button>
          </div>
          {% else %}
          <span class="text-xs text-slate-400">Managed by admin</span>
          {% endif %}
        </td>
      </tr>
      {% else %}
      <tr>
        <td colspan="4" class="px-4 py-6 text-center text-sm text-slate-500">No schedules configured.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% if modal_reset %}
<div id="modal-root" hx-swap-oob="innerHTML"></div>
{% endif %}
